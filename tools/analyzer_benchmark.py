from urllib.request import Request, urlopen

datasets = [
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/17/audio_a86e69ef53.mp3",
        "title": "Sweet Life (Luxury Chill)",
        "artist": "AlexGrohl",
        "tags": "Abstract, Advertising, Background, Chill",
        "bpm": 122.0,
        "first_beat": 23,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/17/audio_673be1728d.mp3",
        "title": "Hype | Drill Music",
        "artist": "kontraa",
        "tags": "Drill, Trap, Hiphop, Type Beat, Classic Hip Hop",
        "bpm": 140.0,
        "first_beat": 9,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/29/audio_07d1c2152a.mp3",
        "title": "We Wish You a Merry Christmas",
        "artist": "original_soundtrack",
        "tags": "We Wish You A Merry Christmas",
        "bpm": 160.0,
        "first_beat": 5237,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/05/26/audio_95504c3693.mp3",
        "title": "Christmas Jazz - Christmas Holiday",
        "artist": "Tunetank",
        "tags": "Holiday, Majestic, Christmas",
        "bpm": 175.0,
        "first_beat": 370,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/06/09/audio_50b8be7252.mp3",
        "title": "Happy Birthday",
        "artist": "BackgroundMusicForVideo",
        "tags": "Happy Birthday, Music",
        "bpm": 100.0,
        "first_beat": -1383,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/26/audio_f8ecd97359.mp3",
        "title": "Christmas",
        "artist": "SigmaMusicArt",
        "tags": "Christmas, Holiday, Christmas Holiday",
        "bpm": 110.0,
        "first_beat": 250,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/07/audio_a9bc5df6b9.mp3",
        "title": "Soft Background Music",
        "artist": "lkoliks",
        "tags": "Background Music, Soft, Background",
        "bpm": 110.0,
        "first_beat": 362,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/10/28/audio_b06293305b.mp3",
        "title": "Christmas Holiday Festive Cheer Snow",
        "artist": "Top-Flow",
        "tags": "Christmas, Holiday, Festive, Merry",
        "bpm": 135.0,
        "first_beat": 232,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/08/29/audio_fba9035557.mp3",
        "title": "Running Night",
        "artist": "Alex_MakeMusic",
        "tags": "Beach, Bright, Commercial, Corporate",
        "bpm": 106.0,
        "first_beat": 14935,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/13/audio_23ba423f80.mp3",
        "title": "Christmas Music",
        "artist": "SigmaMusicArt",
        "tags": "Christmas, Holiday, Christmas Holiday",
        "bpm": 140.08333333333334,
        "first_beat": 2079,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2024/10/24/audio_47145285fd.mp3",
        "title": "Happy Birthday",
        "artist": "saavane",
        "tags": "Happy Birthday, Happy, Birthday, Happy Birthday Song",
        "bpm": 104.0,
        "first_beat": 7205,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/29/audio_d1c955f418.mp3",
        "title": "Jingle Bells",
        "artist": "original_soundtrack",
        "tags": "Jingle Bells, Jingle Bells Music",
        "bpm": 120.0,
        "first_beat": 1563,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/10/21/audio_ada5e33f85.mp3",
        "title": "No Copyright Music",
        "artist": "Tatamusic",
        "tags": "No Copyright Music, No Copyright",
        "bpm": 122.0,
        "first_beat": -142,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/15/audio_37cae78ce7.mp3",
        "title": "Christmas Wishes",
        "artist": "VibeHorn",
        "tags": "Christmas, Background Music",
        "bpm": 119.0,
        "first_beat": 6771,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/05/audio_9fcb027faa.mp3",
        "title": "Background Music",
        "artist": "NastelBom",
        "tags": "Background Music",
        "bpm": 120.0,
        "first_beat": -54,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/06/04/audio_cdce856ddb.mp3",
        "title": "Vlog Beat Background",
        "artist": "Tunetank",
        "tags": "Beat, Beats, Background Beat",
        "bpm": 102.5,
        "first_beat": 34719,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2023/07/22/audio_79e285e137.mp3",
        "title": "Background Music",
        "artist": "The_Mountain",
        "tags": "Background Music, Background Music Soft",
        "bpm": 120.0,
        "first_beat": 21967,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/24/audio_3d409e3117.mp3",
        "title": "Christmas Happy Background",
        "artist": "VibeHorn",
        "tags": "Christmas, Background Music, Christmas Music",
        "bpm": 140.0,
        "first_beat": 273,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/21/audio_8980158ec4.mp3",
        "title": "Christmas",
        "artist": "NikitaKondrashev",
        "tags": "Christmas Music, Christmas Background Music",
        "bpm": 100.0,
        "first_beat": 4628,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/10/28/audio_c2ffa39aa6.mp3",
        "title": "Soft Background Music",
        "artist": "original_soundtrack",
        "tags": "Background Music, Soft, Background",
        "bpm": 120.0,
        "first_beat": 12013,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/10/audio_2b5b4b8f9c.mp3",
        "title": "Epic Cinematic Background Music",
        "artist": "SigmaMusicArt",
        "tags": "Epic, Background, Epic Music, Cinematic, Music For Video",
        "bpm": 149.91666666666666,
        "first_beat": -417,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/10/28/audio_4285598df8.mp3",
        "title": "Groovy Vibe",
        "artist": "Bransboynd",
        "tags": "Good, Food, Baking, Cook, Cooking",
        "bpm": 105.0,
        "first_beat": 1163,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/10/audio_a722babc1f.mp3",
        "title": "Christmas Party",
        "artist": "BFCMUSIC",
        "tags": "Christmas, Background Music",
        "bpm": 119.0,
        "first_beat": 5004,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/08/audio_3e2526c41c.mp3",
        "title": "Deep Abstract Ambient_Snowcap",
        "artist": "ummbrella",
        "tags": "Abstract, Atmosphere, Beat, Chill, Deep",
        "bpm": 123.0,
        "first_beat": 21423,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/10/audio_737472d9be.mp3",
        "title": "No Copyright Music Corporate",
        "artist": "The_Mountain",
        "tags": "No Copyright Music Corporate",
        "bpm": 120.0,
        "first_beat": 213,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2021/11/23/audio_64b2dd1bce.mp3",
        "title": "Just Relax",
        "artist": "music_for_video",
        "tags": "For streaming on Spotify / Apple music and more visit: https://lesfm.net/track/just-relax/",
        "bpm": 120.0,
        "first_beat": 1920,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/11/audio_00132e5c34.mp3",
        "title": "Jingle Bells",
        "artist": "lNPLUSMUSIC",
        "tags": "Jingle Bells, Jingle Bell",
        "bpm": 92.0,
        "first_beat": 281,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/30/audio_a59a02b883.mp3",
        "title": "Cascade Breathe (Future Garage)",
        "artist": "NverAvetyanMusic",
        "tags": "Atmospheric, Cars, Chillstep",
        "bpm": 130.0,
        "first_beat": -9,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/11/audio_f2cf114879.mp3",
        "title": "Background Music",
        "artist": "DELOSound",
        "tags": "Background Music, Background, Background Video",
        "bpm": 81.0,
        "first_beat": 160,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/06/23/audio_e6a00ad257.mp3",
        "title": "Embrace",
        "artist": "Evgeny_Bardyuzha",
        "tags": "Atmospheric, Ambient, Chill, Chillstep",
        "bpm": 130.0,
        "first_beat": 145,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2024/12/09/audio_5c5be993bd.mp3",
        "title": "Vlog Music (Beat Advertising Promo Podcast Background Intro)",
        "artist": "MFCC",
        "tags": "Vlog, Advertising, Podcast, Music, Beat",
        "bpm": 86.0,
        "first_beat": 5352,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/24/audio_29f2d724fd.mp3",
        "title": "Soft Corporate Background Music",
        "artist": "SigmaMusicArt",
        "tags": "Corporate, Background, Music",
        "bpm": 115.0,
        "first_beat": 24960,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/07/20/audio_d39b1267f3.mp3",
        "title": "Energetic Upbeat Background Music",
        "artist": "Tatamusic",
        "tags": "Energetic, Upbeat, Background, Music",
        "bpm": 118.0,
        "first_beat": 22446,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2023/07/30/audio_e0908e8569.mp3",
        "title": "Good Night - Lofi Cozy Chill Music",
        "artist": "FASSounds",
        "tags": "Lofi, Lofi Chill, Cozy Lofi, Advertising",
        "bpm": 160.0,
        "first_beat": 16662,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/04/21/audio_ed6f0ed574.mp3",
        "title": "Brain Implant (Cyberpunk Sci-Fi Trailer Action Intro)",
        "artist": "VasilYatsevich",
        "tags": "Action, Trailer, Cyberpunk, Intense",
        "bpm": 100.0,
        "first_beat": 12,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2024/11/08/audio_05b10daae7.mp3",
        "title": "Showreel Music (Promo Advertising Opener Vlog Background Intro Theme)",
        "artist": "MFCC",
        "tags": "Vlog, Advertising, Showreel, Promo",
        "bpm": 140.0,
        "first_beat": -47,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/05/29/audio_b92a610839.mp3",
        "title": "EONA - Emotional Ambient Pop",
        "artist": "Rockot",
        "tags": "Ambient, Emotional, Dreamy, Cinematic",
        "bpm": 123.0,
        "first_beat": 21445,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/12/audio_d20bec05d4.mp3",
        "title": "Brazilian Phonk - Phonk",
        "artist": "FreeMusicForVideo",
        "tags": "Phonk, Brazilian Phonk, Phonk Music",
        "bpm": 99.20981658459226,
        "first_beat": 26406,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/25/audio_2587948fc0.mp3",
        "title": "Motivation",
        "artist": "NastelBom",
        "tags": "Motivation, Motivation Action",
        "bpm": 87.0,
        "first_beat": 15316,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/17/audio_2d9b17ef14.mp3",
        "title": "Christmas Holiday",
        "artist": "VibeHorn",
        "tags": "Christmas, Background Music",
        "bpm": 151.0,
        "first_beat": 17676,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/15/audio_5ff1210ce0.mp3",
        "title": "Christmas Joyful Opener",
        "artist": "VibeHorn",
        "tags": "Christmas, Background Music",
        "bpm": 119.0,
        "first_beat": 3852,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/12/audio_6b1fec2dff.mp3",
        "title": "Corporate Background Music",
        "artist": "FreeMusicForVideo",
        "tags": "Background Music",
        "bpm": 120.0,
        "first_beat": 21985,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/12/audio_1a5c36d8e1.mp3",
        "title": "Background Music For Video",
        "artist": "DELOSound",
        "tags": "Background Music For Video",
        "bpm": 90.0,
        "first_beat": 29303,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2022/11/11/audio_84306ee149.mp3",
        "title": "Please Calm My Mind",
        "artist": "music_for_video",
        "tags": "Relax, Relaxing, Calm, Calm Down, Piano",
        "bpm": 100.0,
        "first_beat": 2517,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/01/26/audio_3f5c09b7be.mp3",
        "title": "Relaxing Krishna Flute Music. Deep Sleep Relaxing Music",
        "artist": "AlaminHossain1989",
        "tags": "Krishna Flute Music",
        "bpm": 132.0,
        "first_beat": 7910,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/17/audio_f12c1f8299.mp3",
        "title": "Christmas",
        "artist": "SoundGalleryByDmitryTaras",
        "tags": "Christmas, Christmas Piano",
        "bpm": 150.0,
        "first_beat": 17849,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2023/06/26/audio_cd13a5db91.mp3",
        "title": "Happy Birthday",
        "artist": "WaveMaster",
        "tags": "Birthday Bundle, Birthday Cake",
        "bpm": 125.0,
        "first_beat": 126,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/06/25/audio_e8f60a3cf5.mp3",
        "title": "Sad Documentary Background Music",
        "artist": "SigmaMusicArt",
        "tags": "Sad, Documentary, Piano, Sorrowful",
        "bpm": 107.0,
        "first_beat": 2016,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/03/19/audio_91b4c0a3b6.mp3",
        "title": "Experimental Cinematic Hip-Hop",
        "artist": "Rockot",
        "tags": "Cinematic Hip-Hop, Epic Hip-Hop",
        "bpm": 142.0,
        "first_beat": 16,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/10/audio_ac64185c17.mp3",
        "title": "Inspiring Inspirational Music",
        "artist": "PaulYudin",
        "tags": "Inspiring Inspirational Music",
        "bpm": 150.0,
        "first_beat": 194,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/10/audio_f1be28f8ea.mp3",
        "title": "Christmas Party Opener",
        "artist": "BFCMUSIC",
        "tags": "Christmas, Background Music",
        "bpm": 119.0,
        "first_beat": 10861,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2024/10/11/audio_9058a0b8aa.mp3",
        "title": "Christmas Party Time",
        "artist": "BFCMUSIC",
        "tags": "Christmas, Holiday, Sleight Bells",
        "bpm": 140.0,
        "first_beat": 20894,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/30/audio_43a4d0966c.mp3",
        "title": "Funny Cartoon Music",
        "artist": "original_soundtrack",
        "tags": "Funny, Cartoon, Music, Funny Sounds",
        "bpm": 130.0,
        "first_beat": 6162,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/23/audio_a68b7585a6.mp3",
        "title": "Christmas - Christmas Background Music",
        "artist": "MFCC",
        "tags": "Christmas, Christmas Bg, Christmas Music",
        "bpm": 155.0,
        "first_beat": 1252,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2022/04/27/audio_67bcf729cf.mp3",
        "title": "Whip | Afro Dancehall Music",
        "artist": "kontraa",
        "tags": "Afro, Afro Pop, Afro Beat, Dancehall",
        "bpm": 95.0,
        "first_beat": 28982,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/10/08/audio_0eb2c02eb8.mp3",
        "title": "No Copyright Music",
        "artist": "SigmaMusicArt",
        "tags": "No Copyright Music, No Copyright",
        "bpm": 115.0,
        "first_beat": 22735,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/10/21/audio_5f4a9e89f5.mp3",
        "title": "Soft Background Music",
        "artist": "HitsLab",
        "tags": "Background Music, Soft, Background",
        "bpm": 120.0,
        "first_beat": 26,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/15/audio_7c2a126995.mp3",
        "title": "Horror Playhouse",
        "artist": "geoffharvey",
        "tags": "Horror, Halloween, Creepy, Scary",
        "bpm": 93.25,
        "first_beat": 12618,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/23/audio_36852d37ed.mp3",
        "title": "Soft Background Music",
        "artist": "FreeMusicForVideo",
        "tags": "Background Music, Soft",
        "bpm": 120.0,
        "first_beat": 22056,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/10/audio_cdd263b180.mp3",
        "title": "Epic Cinematic Background Music",
        "artist": "PaulYudin",
        "tags": "Epic Cinematic Background Music, Epic Cinematic Epic",
        "bpm": 110.0,
        "first_beat": 24559,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/10/audio_1a6f9cce71.mp3",
        "title": "Soft Corporate Presentation Background Music",
        "artist": "SigmaMusicArt",
        "tags": "Corporate, Background, Music, Background Music",
        "bpm": 120.0,
        "first_beat": 21908,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2024/10/28/audio_6438122991.mp3",
        "title": "Emotional Piano Music",
        "artist": "SigmaMusicArt",
        "tags": "Calm, Soft, Piano, Relax, Instrumental",
        "bpm": 140.0,
        "first_beat": 154,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/05/audio_680009f825.mp3",
        "title": "Christmas Background",
        "artist": "BFCMUSIC",
        "tags": "Christmas, Holiday, Christmas Holiday",
        "bpm": 110.0,
        "first_beat": 24314,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/24/audio_41cfa6f4ea.mp3",
        "title": "Inspiring Inspirational Music",
        "artist": "SigmaMusicArt",
        "tags": "Inspirational Music, Inspirational Background",
        "bpm": 154.0,
        "first_beat": 17301,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/08/26/audio_7dbc61a1f5.mp3",
        "title": "Motivation Motivational Music",
        "artist": "lkoliks",
        "tags": "Motivation, Motivational",
        "bpm": 90.0,
        "first_beat": 130,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/09/audio_f732435615.mp3",
        "title": "Happy Birthday",
        "artist": "FreeMusicForVideo",
        "tags": "No Copyright Music, No Copyright, Happy",
        "bpm": 124.0,
        "first_beat": 11,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/14/audio_a0d88c03d8.mp3",
        "title": "Merry Christmas",
        "artist": "VibeHorn",
        "tags": "Christmas, Background Music",
        "bpm": 144.0,
        "first_beat": -39,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/08/audio_7e9f339833.mp3",
        "title": "Kids Happy Background Music",
        "artist": "SigmaMusicArt",
        "tags": "Kids, Child, Baby, Happy, Childhood",
        "bpm": 90.0,
        "first_beat": 258,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/18/audio_93dd341fe2.mp3",
        "title": "Christmas Show",
        "artist": "VibeHorn",
        "tags": "Christmas, Holiday, Christmas Holiday",
        "bpm": 119.0,
        "first_beat": 899,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/23/audio_ec4233c461.mp3",
        "title": "Soft Inspiring Corporate Background Music",
        "artist": "SigmaMusicArt",
        "tags": "Corporate, Background, Music",
        "bpm": 120.0,
        "first_beat": 22069,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2024/04/14/audio_5d6668b1f0.mp3",
        "title": "For Her Chill Upbeat Summel Travel Vlog and IG Music Royalty Free Use",
        "artist": "34910776",
        "tags": "Travel Vlog, Vlog Music, Female Vocals",
        "bpm": 90.0,
        "first_beat": -74,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/07/29/audio_2a1b68d9d9.mp3",
        "title": "No Copyright Music",
        "artist": "original_soundtrack",
        "tags": "No Copyright Music, No Copyright",
        "bpm": 110.0,
        "first_beat": 1374,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/02/18/audio_67a824edf7.mp3",
        "title": "Kugelsicher by TremoxBeatz",
        "artist": "TremoxBeatz",
        "tags": "Prod By Tremoxbeatz, Free Type Beat",
        "bpm": 92.0,
        "first_beat": 1213,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/08/audio_6dfb853ab5.mp3",
        "title": "Upbeat Music",
        "artist": "original_soundtrack",
        "tags": "Upbeat, Upbeat Bg, Upbeat Pop",
        "bpm": 100.0,
        "first_beat": 7576,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/09/audio_1ac0de4a8e.mp3",
        "title": "long bg music",
        "artist": "u_lj2gazwuc9",
        "tags": "Corporate, Instrumental, Uplifting",
        "bpm": 120.05621276063582,
        "first_beat": 4421,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/08/14/audio_c91b0e7d23.mp3",
        "title": "Retro Lounge",
        "artist": "Bransboynd",
        "tags": "Retro, Vintage, Minimalist, Lounge",
        "bpm": 115.0,
        "first_beat": 2939,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/09/07/audio_1dcbce3454.mp3",
        "title": "Corporate Upbeat Uplifting Motivational Success",
        "artist": "Top-Flow",
        "tags": "Corporate, Success, Business, Growth",
        "bpm": 125.0,
        "first_beat": 988,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/09/audio_3240ebb718.mp3",
        "title": "Christmas - Christmas Background Music",
        "artist": "The_Mountain",
        "tags": "Christmas Background Music",
        "bpm": 119.0,
        "first_beat": 1556,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/26/audio_d26ea4406e.mp3",
        "title": "Tense Suspense Background Music",
        "artist": "DELOSound",
        "tags": "Tense, Suspense, Tense Suspense Background Music, Background",
        "bpm": 160.0,
        "first_beat": 17185,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/12/10/audio_b05e690828.mp3",
        "title": "Snow Lantern Waltz",
        "artist": "BFCMUSIC",
        "tags": "Christmas, Holiday, Christmas Holiday",
        "bpm": 119.0,
        "first_beat": 50,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/15/audio_b28a417508.mp3",
        "title": "Christmas Music",
        "artist": "SoundGalleryByDmitryTaras",
        "tags": "Christmas, Christmas Music, Christmas Background",
        "bpm": 135.0,
        "first_beat": 2438,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/04/30/audio_9834479b67.mp3",
        "title": "Happy Birthday",
        "artist": "BackgroundMusicForVideos",
        "tags": "Happy Birthday, Music",
        "bpm": 107.0,
        "first_beat": 18123,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/10/14/audio_7a423da5ba.mp3",
        "title": "Breaking News Intro Music",
        "artist": "Krasnoshchok",
        "tags": "Breaking News, News, Intro, Music",
        "bpm": 100.0,
        "first_beat": 26524,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/11/13/audio_46e5c6ce2e.mp3",
        "title": "Ready For Christmas - Santa Workshop Happiness",
        "artist": "Sonican",
        "tags": "Christmas, Holiday, Christmas Music",
        "bpm": 107.0,
        "first_beat": 36600,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2021/10/15/audio_2320f2b0bc.mp3",
        "title": "Epic Hollywood Trailer",
        "artist": "Good_B_Music",
        "tags": "Battle, Buildup, Choir, Cinematic",
        "bpm": 120.0,
        "first_beat": 864,
        "samplerate": 22050.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/03/19/audio_56ae1dae5f.mp3",
        "title": "Gorila",
        "artist": "Alex_MakeMusic",
        "tags": "Beach, Bright, Commercial, Corporate",
        "bpm": 158.0,
        "first_beat": 18161,
        "samplerate": 24000.0,
    },
    {
        "source": "https://cdn.pixabay.com/audio/2025/05/20/audio_ec1f11ca43.mp3",
        "title": "Future Design",
        "artist": "penguinmusic",
        "tags": "Abstract, Background, Bass, Beat",
        "bpm": 120.0,
        "first_beat": 11080,
        "samplerate": 22050.0,
    },
]


# for record in datasets:
#     headers = {
#         'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:146.0) Gecko/20100101 Firefox/146.0',
#         'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
#         'Accept-Language': 'en-GB,en;q=0.5',
#         'Accept-Encoding': 'gzip, deflate, br, zstd',
#         'DNT': '1',
#         'Sec-GPC': '1',
#         'Connection': 'keep-alive',
#         'Upgrade-Insecure-Requests': '1',
#         'Sec-Fetch-Dest': 'document',
#         'Sec-Fetch-Mode': 'navigate',
#         'Sec-Fetch-Site': 'none',
#         'Sec-Fetch-User': '?1',
#         'Priority': 'u=0, i',
#         'TE': 'trailers'
#     }
#     req = Request(record['source'], headers=headers)
#     with urlopen(req) as response:
#         filename = f"{record['title']} - {record['artist']}.mp3"
#         print(f"Downloading {filename}...")
#         with open(filename, 'wb') as f:
#             f.write(response.read())


# import json
# import beats_pb2
# import base64

# beat = None
# with open("result.json") as f:
#     d = json.load(f)
#     for record in d:
#         if record["color"] is not None: continue
#         beat = beats_pb2.BeatGrid()
#         beat.ParseFromString(base64.b64decode(record["beats"].encode()))
#         for d in datasets:
#             if f"/home/developer/Music/benchmark/{d['title']} - {d['artist']}.mp3" == record["location"]:
#                 d.update(dict(bpm=beat.bpm.bpm, first_beat=beat.first_beat.frame_position, samplerate=record["samplerate"]/2))
#                 break
#         # print(beat.bpm, beat.first_beat)

# print(json.dumps(datasets))

import multiprocessing
import subprocess
import json


def process(record):
    filename = f"/home/developer/Music/benchmark/{record['title']} - {record['artist']}.mp3"
    proc = subprocess.Popen(
        ["/workspaces/mixxx/build/mixxx-test", "--analyser", filename],
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE,
    )
    proc.wait()
    if proc.returncode != 0:
        print(f"Got error code {proc.returncode} on {filename}")
        raise Exception(proc.stderr.read())
    output = json.loads(proc.stdout.read())
    beat_length = record["samplerate"] * 60 / record["bpm"]
    runtime = output["runtime"]
    grid_offset = (
        abs(record["first_beat"] - output["offset"]) / beat_length
    ) % 1
    offset = abs(2 * grid_offset - 1)
    delta = record["bpm"] - output["bpm"]
    delta = (
        f"+{delta:.2f}"
        if delta > 0
        else (f"{delta:.2f}" if delta < 0 else "-")
    )
    return [
        f"{record['title']} - {record['artist']}]({record['source']})",
        record["bpm"],
        output["bpm"],
        delta,
        int(offset * 100),
        runtime / 1000,
    ]
    # print(record)


with multiprocessing.Pool(multiprocessing.cpu_count()) as p:
    report = p.map(process, datasets)
    # TODO array max
    print(
        "\n".join(
            [
                f"| [{record[0]:<145} | {record[1]:<6.2f} | {record[2]:<6.2f} | {record[3]:<6} | {record[4]:>3}% | {record[5]:>6.2f} seconds |"
                for record in report
            ]
        )
    )
