<!--
Description:
  The Library container.
  Left: Preview deck, CoverArt and Tree view (collapsible)
  Right: Tracks table.
-->
<Template>
  <SingletonDefinition>
    <ObjectName>LibraryBreadCrumbSingleton</ObjectName>
    <Children>
      <LibraryBreadCrumb>
        <ObjectName>LibraryBreadCrumb</ObjectName>
        <SizePolicy>me,min</SizePolicy>
        <Id>1</Id>
      </LibraryBreadCrumb>
    </Children>
  </SingletonDefinition>

  <SingletonDefinition>
    <ObjectName>LibrarySearchBoxSingleton</ObjectName>
    <Children>
      <WidgetGroup>
        <SizePolicy>me,min</SizePolicy>
        <Layout>horizontal</Layout>
        <Children>

          <SearchBox>
            <Id>1</Id>
          </SearchBox>

          <WidgetGroup>
            <SizePolicy>min,min</SizePolicy>
            <Layout>horizontal</Layout>
            <Children>
            </Children>
          </WidgetGroup>

        </Children>
      </WidgetGroup>
    </Children>
  </SingletonDefinition>

  <WidgetGroup>
<!-- Finally fixed: library can shrink to noting!
    Solution was to define SizePolicy as 'xx,i'.
    Found this in Deere-2.1 -->
    <ObjectName>Library</ObjectName>
    <SizePolicy>me,i</SizePolicy>
    <Layout>vertical</Layout>
    <Children>

      <WidgetGroup>
        <Size>1me,2f</Size>
        <Connection>
          <ConfigKey persist="true">[Master],maximize_library</ConfigKey>
          <BindProperty>visible</BindProperty>
        </Connection>
      </WidgetGroup>

      <Splitter><!-- Library -->
        <ObjectName>LibrarySplitter</ObjectName>
        <SizePolicy>me,me</SizePolicy>
        <SplitSizes>1,6</SplitSizes>
        <SplitSizesConfigKey>[Tango],lib_cover_feature_splitter</SplitSizesConfigKey>
        <Orientation>horizontal</Orientation>
        <Collapsible>1,0</Collapsible>
        <Children>

          <!-- SidebarButtons + [Preview + FeaturePane + CoverArt] -->
          <WidgetGroup>
            <Layout>vertical</Layout>
            <!-- minSize so that 8 Preview HotCues fit nicely, 23+1px each -->
            <Size>132min,74me</Size>
            <Children>

              <Template src="skin:library_sidebar_tester.xml"/>

              <Template src="skin:preview_deck.xml"/>

              <WidgetGroup>
                <Size>0min,5f</Size>
                <Connection>
                  <ConfigKey persist="true">[PreviewDeck],show_previewdeck</ConfigKey>
                  <BindProperty>visible</BindProperty>
                </Connection>
              </WidgetGroup>

              <WidgetGroup>
                <Layout>horizontal</Layout>
                <Children>

                  <WidgetGroup>
                    <ObjectName>SidebarButtonsContainer</ObjectName>
                    <SizePolicy>min,min</SizePolicy>
                    <Layout>vertical</Layout>
                    <Children>
                      <!-- Show expand toggle above Sidebar buttons
                      if Sidebar is wide enough (>139px) -->
                      <WidgetGroup>
                        <Layout>horizontal</Layout>
                        <SizePolicy>min,min</SizePolicy>
                        <Children>
                          <WidgetGroup><Size>0min,0min</Size></WidgetGroup>
                          <Template src="skin:button_2state_persist.xml">
                            <SetVariable name="ObjectName">LibMiniMaxiButton</SetVariable>
                            <SetVariable name="Size">22f,22f</SetVariable>
                            <SetVariable name="ConfigKey">[Master],maximize_library</SetVariable>
                          </Template>
                          <WidgetGroup><Size>0min,0min</Size></WidgetGroup>
                        </Children>
                        <Connection>
                          <ConfigKey>[Skin],lib_sidebar_collapsed</ConfigKey>
                          <Transform><Not/></Transform>
                          <BindProperty>visible</BindProperty>
                        </Connection>
                      </WidgetGroup>

                      <WidgetGroup>
                        <Layout>horizontal</Layout>
                        <SizePolicy>min,min</SizePolicy>
                        <Children>
                          <WidgetGroup><Size>0min,0min</Size></WidgetGroup>
                          <Template src="skin:button_2state_persist.xml">
                            <SetVariable name="ObjectName">LibCoverArtButton</SetVariable>
                            <!-- Icon size is 48x48px (24x24px), margin: left 2px, bottom 4px -->
                            <SetVariable name="Size">26f,28f</SetVariable>
                            <SetVariable name="ConfigKey">[Library],show_coverart</SetVariable>
                          </Template>
                          <WidgetGroup><Size>0min,0min</Size></WidgetGroup>
                        </Children>
                      </WidgetGroup>

                      <LibrarySidebarButtons>
                        <SizePolicy>min,me</SizePolicy>
                        <ObjectName>LibrarySidebarButtons</ObjectName>
                      </LibrarySidebarButtons>

                    </Children>
                  </WidgetGroup>

                  <WidgetGroup><!-- Preview + FeaturePane + CoverArt -->
                    <Layout>vertical</Layout>
                    <SizePolicy>min,me</SizePolicy>
                    <Children>

                      <!-- Show BreadCrumbs above tree view
                      if Sidebar is wide enough (>139px) -->
                      <SingletonContainer>
                        <ObjectName>LibraryBreadCrumbSingleton</ObjectName>
                        <Connection>
                          <ConfigKey>[Skin],lib_sidebar_collapsed</ConfigKey>
                          <Transform><Not/></Transform>
                          <BindProperty>visible</BindProperty>
                        </Connection>
                      </SingletonContainer>

                      <Splitter><!-- Splitter to make CoverArt resizeable -->
                        <ObjectName>LibrarySplitter</ObjectName>
                        <SizePolicy>me,me</SizePolicy>
                        <SplitSizes>1,3</SplitSizes>
                        <SplitSizesConfigKey>[Tango],splitter__coverArt_tree</SplitSizesConfigKey>
                        <Orientation>vertical</Orientation>
                        <Collapsible>0,0</Collapsible>
                        <Children>
                          <LibrarySidebarExpanded>
                            <ObjectName>LibrarySidebarExpanded</ObjectName>
                            <Id>1</Id>
                          </LibrarySidebarExpanded>

                          <CoverArt>
                            <Size>30min,30min</Size>
                            <Connection>
                              <ConfigKey persist="true">[Library],show_coverart</ConfigKey>
                              <BindProperty>visible</BindProperty>
                            </Connection>
                          </CoverArt>
                        </Children>
                      </Splitter><!-- /Splitter to make CoverArt resizeable -->

                    </Children>
                  </WidgetGroup><!-- /Preview + FeaturePane + CoverArt -->

                </Children>
              </WidgetGroup><!-- SidebarButtons + [Preview + FeaturePane + CoverArt] -->

            </Children>
          </WidgetGroup>

          <WidgetGroup>
            <SizePolicy>me,min</SizePolicy>
            <Layout>vertical</Layout>
            <Children>

              <WidgetGroup>
                <Layout>horizontal</Layout>
                <SizePolicy>min,min</SizePolicy>
                <Children>
                  <!-- Show expand toggle and BreadCrumbs above tracks table
                  if Sidebar is too small or collapsed (<140px) -->
                  <WidgetGroup>
                    <Layout>horizontal</Layout>
                    <Size>180min,-1min</Size>
                    <Children>
                      <Template src="skin:button_2state_persist.xml">
                        <SetVariable name="ObjectName">LibMiniMaxiButton</SetVariable>
                        <SetVariable name="Size">22f,28f</SetVariable>
                        <SetVariable name="ConfigKey">[Master],maximize_library</SetVariable>
                      </Template>

                      <WidgetGroup><Size>5f,0min</Size></WidgetGroup>

                      <SingletonContainer>
                        <ObjectName>LibraryBreadCrumbSingleton</ObjectName>
                      </SingletonContainer>
                    </Children><!-- -->
                    <Connection>
                      <ConfigKey>[Skin],lib_sidebar_collapsed</ConfigKey>
                      <BindProperty>visible</BindProperty>
                    </Connection>
                  </WidgetGroup>

                  <SingletonContainer>
                    <ObjectName>LibrarySearchBoxSingleton</ObjectName>
                  </SingletonContainer>
                </Children>
              </WidgetGroup>

              <LibraryPane>
                <BgColor>#585858</BgColor>
                <FgColor>#eece33</FgColor>
                <Id>1</Id>
              </LibraryPane>
            </Children>
          </WidgetGroup>

        </Children>
      </Splitter><!-- /Split Tree / Tracks table -->

    </Children>
    <Connection>
      <ConfigKey persist="true">[Library],show_library</ConfigKey>
      <BindProperty>visible</BindProperty>
    </Connection>
  </WidgetGroup>
</Template>
